<!DOCTYPE html>
<html>
  <head>
    <title>KNN Results</title>
    <head>
      <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='knn.css') }}">
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="{{ url_for('static', filename='file.js') }}"></script>
      <style>
        table {
          border-collapse: collapse;
          width: 100%;
        }
        th, td {
          text-align: center;
          padding: 8px;
        }
        th {
          background-color: #4CAF50;
          color: white;
        }
        tr:nth-child(even) {
          background-color: #f2f2f2;
        }
        .sex, .age, .year {
          color: #007bff;
          font-weight: bold;
        }
        .class, .g11, .g12, .predicted-result {
          color: green;
          font-weight: bold;
        }
        .grade, .descriptive {
          color: red;
          font-weight: bold;
        }
        .upload-time {
          font-size: 14px;
          color: #666;
          margin-left: 10px;
        }
        
      </style>
    </head>
  
    <body>
      <div class="container">
        
        <form action="{{ url_for('piecharts2') }}" method="post">
          <input type="hidden" name="descriptive_chart_url" value="{{ descriptive_chart_url }}">
          <input type="hidden" name="grade_chart_url" value="{{ grade_chart_url }}">
          <input type="hidden" name="results_with_grades" value="{{ results_with_grades }}">
          <a href="/superadmin" class="home-button">Home</a>
                <button type="submit" class="pie-chart-button">View Results with Pie Charts</button>
      </form>
      
        <h1>K-Nearest Neighbors Results</h1>
        <form method="POST" enctype="multipart/form-data" action="{{ url_for('upload_file') }}">
          <label for="file-upload" class="custom-file-upload">Upload Data File</label>
          <input id="file-upload" type="file" name="file" onchange="document.getElementById('file-name').innerHTML = this.files[0].name;">
          <span id="file-name"></span>
          <input type="submit" value="Upload" class="upload-button" onclick="addRandomString()">
          <span class="upload-time">Uploaded in {{ upload_time }} seconds</span>
          <span id="upload-time" class="upload-time"></span>


        </form>
        <div class="search-container">
          <input type="text" id="search-box" class="search-box" placeholder="Search...">
          <button type="button" class="search-button" onclick="searchTable()">Search</button>
        </div>
        
        </form>
            
        <table>
          <thead>
            <tr>
              <th class="">Name</th>
              <th class="">Sex</th>
              <th class="">Age</th>
              <th class="">Year</th>
              <th class="">Grade 11 GWA</th>
              <th class="">Grade 12 GWA</th>
              <th class="">Class</th>
              <th class="">Predicted Result</th>
              <th class="">Grade</th>
              <th class="">Descriptive</th>
            </tr>
          </thead>
          <tbody id="table-body">
            {% for result in results_with_grades | sort(attribute='name') %}
            <tr>
              <td class="name">{{ result['name'] }}</td>
              <td class="sex">{{ result['sex'] }}</td>
              <td class="age">{{ result['age'] }}</td>
              <td class="year">{{ result['year'] }}</td>
              <td class="g11">{{ result['g11'] }}</td>
              <td class="g12">{{ result['g12'] }}</td>
              <td class="class">{{ result['class'] }}</td>
              <td class="predicted-result">{{ result['predicted_result'] }}</td>
              <td class="grade">{{ result['grade'] }}</td>
              <td class="descriptive">{{ result['descriptive'] }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <canvas id="scatter-chart"></canvas>

          </div>
        </body><script>
          function displayUploadTime(startTime) {
            var endTime = new Date();
            var timeDiff = endTime - startTime;
            var seconds = Math.round(timeDiff / 1000);
            var minutes = Math.floor(seconds / 60);
            seconds = seconds % 60;
            document.getElementById("upload-time").innerHTML = "File uploaded in " + minutes + "m " + seconds + "s";
          }
        
          document.getElementById("file-upload").addEventListener("change", function() {
            var startTime = new Date();
            displayUploadTime(startTime);
          });
        </script>
        